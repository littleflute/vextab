
<html><head>  <title>blclassTest</title>
  <script src="https://littleflute.github.io/vc6/XdHtml/blclass.js"></script>
  <script src="../releases/vextab-div.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.2.1/lodash.js"></script>
  <script src="https://code.jquery.com/jquery-2.2.0.min.js"></script>  
</head>
<body>
  <div style="float:left;display:none;">
    <!-- ----ta0---- -->
    <textarea id="ta0">options scale=1.0 space=20 tab-stems=true stave-distance=40 tab-stem-direction=down
tabstave notation=true key=A time=4/4
notes :q =|: (5/2.5/3.7/4) :8 7-5h6/3 ^3^ 5h6-7/5 ^3^ :q 7V/4 |
notes :8 t12p7/4 s5s3/4 :8 3s:16:5-7/5 :h p5/4
text :w, |#segno, ,|, :hd, , #tr

options space=65
tabstave notation=true
notes :q (5/4.5/5) (7/4.7/5)s(5/4.5/5) ^3^
notes :8 7-5/4 $.a./b.$ (5/4.5/5)h(7/5) =:|
notes :8 (12/5.12/4)ds(5/5.5/4)u 3b4/5
notes :h (5V/6.5/4.6/3.7/2) $.italic.let ring$ =|=
text :h, ,.font=Times-12-italic, D.S. al coda, |#coda
text :h, ,.-1, .font=Arial-14-bold,A13
text ++, .30, #f

options space=70</textarea><!-- ====ta0==== -->

<!-- ----ta1---- -->
<textarea id="ta1">

    
options space=20
tabstave notation=true tablature=false  
key=A time=4/4
notes :8 B/4 :q C/5 :8 B/4 :q C/5 B/4 |  :8 B/4 :q C/5 :8 B/4 :qd C/5 :8 E/4 |  F-A-A-A/4 B-G-E/4-C/5 | :h bC/5 :qd bC/5 :8 E/5|
text :w, .1, A, A,|
text :h, .1, D, E,| 
text :w, .1, F#m

options space=20
tabstave notation=true tablature=false

key=A time=4/4
notes :8 F-E/5 :q F/5 :8 D-C/5-B-A/4 |:h bA/4 E/4 |:q A/4 :8 C/5 B/4 bB/4 E-F-E/4 |:q A/4
text :h, .1, D, E,| 
text :w, .1, A
text :w, .1, A  

options space=25

</textarea> <!-- ====ta1==== -->

<!-- ----s1---- -->
<textarea id="s1">

options scale=1.1 space=20 tab-stems=true stave-distance=40 tab-stem-direction=down
tabstave notation=true key=C time=4/4  

</textarea> <!-- ====s1==== -->
</div>

<script>
function _blEditClass (_o,_d,_t){
	this.v = "v0.0.34";
	var o = _o;
	var d = _d;
	var ta = _t;
	var r = blo0.blDiv(o,o.id+"_blMajorChordClass","_blMajorChordClass",blColor[4]);	 
  	r.C = blo0.blBtn(r,r.id + "C","C",blGrey[3]);  	
	r.C.onclick = function(){		ta.value += bl$("s1").value + _strMajorChord(1,2); d.showVextab(); 		}
  	r.D = blo0.blBtn(r,r.id + "D","D",blGrey[3]);  	
	r.D.onclick = function(){		ta.value += bl$("s1").value + _strMajorChord(3,2); d.showVextab(); 		}
  	r.E = blo0.blBtn(r,r.id + "E","E",blGrey[3]);
  	r.E.onclick = function(){		ta.value += bl$("s1").value + _strMajorChord(5,2); d.showVextab(); 		}
	function _strMajorChord(i,j){
		var r = "notes :8  " + i + "/" + j + " " + (i+4)+ "/" + j +" " + (i+7) + "/" + j + " " + (i+12) + "/" + j + " " + (i+7) +"/" + j + " |";
		return r;
	}
	var r = blo0.blDiv(o,o.id+"_add_line","[+line]",blColor[4]);	 
  	r.a0 = blo0.blBtn(r,r.id + "a0","a0",blGrey[0]);r.a0.onclick = function(){	ta.value += "\ntabstave"; d.showVextab(); }
  	r.a1 = blo0.blBtn(r,r.id + "a1","a1",blGrey[0]);r.a1.onclick = function(){ta.value += "\ntabstave notation=true clef=bass key=Ab time=C| \n notes 4-5/6"; d.showVextab(); }
  	r.a2 = blo0.blBtn(r,r.id + "a2","a2",blGrey[0]);r.a2.onclick = function(){ta.value += "\ntabstave notation=true tablature=false \n notes Cn-D-E/4 F#/5"; d.showVextab(); }
	r.a3 = blo0.blBtn(r,r.id + "a3","a3",blGrey[0]);r.a3.onclick = function(){ta.value += "\ntabstave notation=true \n notes 4-5-6/3 10/4"; d.showVextab(); }
}
function _blSongEditClass (_d,_t){
	this.v = "v0.0.33";
	var _v = null;
	var d = _d;
	var ta = _t;
	this.blr_Edit = function(btn,div){
		if(!_v){_v=blo0.blDiv(div,div.id+"_v","v::",blGrey[0]);_v.majorChord = new _blEditClass(_v,d,ta);}
		_on_off_div(btn,div);	
	};	this.bll1= "--1--";
	this.blr_Songs = function(btn,div){
		if(!div.v){
			div.v=blo0.blDiv(div,div.id+"_v","samples",blColor[0]); 			
			div.v.msg=blo0.blDiv(div.v,div.v.id+"msg","msg:",blColor[3]); 	
			div.v.tb=blo0.blDiv(div.v,div.v.id+"tb","tb:",blGrey[2]); 
			var b1 = blo0.blBtn(div.v.tb,div.v.tb.id + "b1","[+song]",blColor[1]);
			b1.onclick = function(this_){
				var ns = [];
				return function(){
					var id = this_.id + (ns.length + 1);
					var html = "ns" + (ns.length + 1)
					var b = blo0.blBtn(div.v.tb,id,html,blColor[1]);
					b.onclick = function(){div.v.msg.innerHTML = this.id;};
					ns.push(b);
				}
			}(b1);

			var t = document.getElementsByTagName("textarea");
			for (var i = 0; i < t.length; i++){
				if(t[i].id!="blah")
				{	
					var b = blo0.blBtn(div.v.tb,div.v.tb.id + t[i].id,t[i].id,blGrey[0]);
					b.onclick = function(tt){return function(){ta.value = tt.value; d.showVextab();}}(t[i]);
				}
			}
		}_on_off_div(btn,div);		
	}; this.bll2= "--2--"; 
}
function _blChordToolBar (_o,_d){
	var d	= _d;
	var ta 	= d.dt.dta.ta;
	var o	= _o;
	var r = blo0.blDiv(o,o.id+"chord","",blGrey[1]);
	var de = null;
 
  	r.e = blo0.blBtn(o,o.id + "e","e",blGrey[3]);
  	r.e.onclick = function(){
		if(!de){de=blo0.blDiv(o,o.id+ "_div_e","e:",blGrey[4]);de.o = new _blSongEditClass(d,ta);blo0.blShowObj2Div(de,de.o);}
		_on_off_div(this,de);
  	}
	return r;
}
function _blUIClass (v){
  this.blRender = function(){alert(v);};

  var s0 = '<div id="id_div_toolbar">';
  s0 += '<a target="_blank" href="https://github.com/littleflute/vextab/edit/master/tests/blclassTest.html">' + v + '</a>';
  s0 += '</div>';
  var d = blo0.blMDiv(document.body,"id_blClassDiv_4_wrap1",s0,10,10,500,200,"gold");
  d.tb = bl$("id_div_toolbar");
  d.showVextab = function(_this){	return function(){_this.blRender();};  }(this);
  d.tb.b1 = blo0.blBtn(d.tb,d.tb.id + "b1","b1",blGrey[0]);
  d.tb.b1.onclick = function(){	_on_off_div(this,d.dt);  }
  d.tb.b2 = blo0.blBtn(d.tb,d.tb.id + "b2","b2",blGrey[0]);
  d.tb.b2.onclick = function(){	_on_off_div(this,d.handle);	_on_off_div(this,d.main);  } 
  var s = '<canvas id="boo"></canvas>';  
  var d1 = blo0.blDiv(d,"id_div_4_vextab",s,"white");

  var s1 = '<div id="id_div_toolbar0_4_ta"></div>';
  d.dt = blo0.blMDiv(document.body,"id_blClassDiv_4_wrap2",s1,800,10,500,200,"gray");
  d.dt.tb0 = blo0.blDiv(bl$("id_div_toolbar0_4_ta"),bl$("id_div_toolbar0_4_ta").id+"tb0","tb0::",blGrey[0]);
  d.dt.tb0.b1 = blo0.blBtn(d.dt.tb0,d.dt.tb0.id + "b1","b1",blGrey[0]);
  d.dt.tb0.b1.onclick = function(){	_on_off_div(this,d.dt.handle);	_on_off_div(this,d.dt.main);   }


  d.dt.dta = blo0.blDiv(d.dt,"id_div_4_ta","","blue");
  d.dt.de = blo0.blDiv(d.dt,"error","de","red");
  

  d.dt.dta.ta = blo0.blTextarea(d.dt.dta,"blah","",blColor[4]);d.dt.dta.ta.style.width="100%",d.dt.dta.ta.style.height="200px";

  d.dt.ctb = _blChordToolBar(bl$("id_div_toolbar0_4_ta"),d); 

  var ta0= bl$("ta0"); 
  d.dt.dta.ta.value = ta0.value;
  d.tb.b1.click();
  d.tb.b2.click();
  d.dt.tb0.b1.click();
}

</script>
<script>        
  // Load VexTab module.    
  vextab = VexTabDiv;
    $(function() {
	var blco = new _blUIClass ("v0.1.244") ;
      VexTab = vextab.VexTab;
      Artist = vextab.Artist;
      Renderer = Vex.Flow.Renderer;
      Artist.DEBUG = true;
      VexTab.DEBUG = false;
      // Create VexFlow Renderer from canvas element with id #boo
      renderer = new Renderer($('#boo')[0], Renderer.Backends.CANVAS);
      // Initialize VexTab artist and parser.
      artist = new Artist(10, 10, 600, {scale: 0.8});
      vextab = new VexTab(artist);
      function render() {
        try {
          vextab.reset();
          artist.reset();
          vextab.parse($("#blah").val());
          artist.render(renderer);
          $("#error").text("");
        } catch (e) {
          console.log(e);
          $("#error").html(e.message.replace(/[\n]/g, '<br/>'));
        }
      }
      $("#blah").keyup(_.throttle(render, 250));
      blco.blRender = render;
      blco.blRender();
    });
  
</script>
</body></html>
